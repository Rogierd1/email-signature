<!DOCTYPE html>
<html lang="nl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Qisum Email Handtekening Generator</title>
  <style>
    * {
      box-sizing: border-box;
    }
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: #f5f5f5;
      margin: 0;
      padding: 20px;
      color: #333;
    }
    .container {
      max-width: 900px;
      margin: 0 auto;
    }
    header {
      text-align: center;
      margin-bottom: 30px;
    }
    header h1 {
      color: #0D0D0D;
      margin-bottom: 8px;
    }
    header p {
      color: #666;
      margin: 0;
    }
    .main-content {
      display: flex;
      gap: 30px;
      flex-wrap: wrap;
    }
    .form-section {
      flex: 1;
      min-width: 300px;
      background: white;
      padding: 24px;
      border-radius: 12px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.08);
    }
    .preview-section {
      flex: 1;
      min-width: 300px;
    }
    .form-group {
      margin-bottom: 16px;
    }
    .form-group label {
      display: block;
      font-weight: 500;
      margin-bottom: 6px;
      color: #333;
    }
    .form-group input {
      width: 100%;
      padding: 10px 12px;
      border: 1px solid #ddd;
      border-radius: 6px;
      font-size: 14px;
      transition: border-color 0.2s;
    }
    .form-group input:focus {
      outline: none;
      border-color: #FF1469;
    }
    .preview-box {
      background: white;
      padding: 24px;
      border-radius: 12px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.08);
      margin-bottom: 16px;
    }
    .preview-box h3 {
      margin: 0 0 16px 0;
      color: #333;
      font-size: 14px;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }
    #signature-preview {
      border: 1px dashed #ddd;
      padding: 16px;
      background: #fafafa;
      border-radius: 6px;
    }
    .btn {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      padding: 12px 24px;
      font-size: 15px;
      font-weight: 600;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.2s;
      width: 100%;
    }
    .btn-primary {
      background: #FF1469;
      color: white;
    }
    .btn-primary:hover {
      background: #e01260;
      transform: translateY(-1px);
    }
    .btn-primary:active {
      transform: translateY(0);
    }
    .btn svg {
      width: 18px;
      height: 18px;
    }
    .copy-feedback {
      text-align: center;
      padding: 8px;
      margin-top: 8px;
      border-radius: 6px;
      font-size: 14px;
      display: none;
    }
    .copy-feedback.success {
      display: block;
      background: #e8f5e9;
      color: #2e7d32;
    }
    .copy-feedback.error {
      display: block;
      background: #ffebee;
      color: #c62828;
    }
    .instructions {
      background: white;
      padding: 24px;
      border-radius: 12px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.08);
      margin-top: 30px;
    }
    .instructions h2 {
      margin: 0 0 20px 0;
      color: #333;
    }
    .instructions h3 {
      margin: 20px 0 12px 0;
      color: #FF1469;
      font-size: 16px;
    }
    .instructions ol {
      margin: 0;
      padding-left: 20px;
      line-height: 1.8;
    }
    .instructions li {
      margin-bottom: 4px;
    }
    .note {
      background: #fff8e1;
      border-left: 4px solid #ffc107;
      padding: 12px 16px;
      margin-top: 16px;
      border-radius: 0 6px 6px 0;
      font-size: 14px;
    }
    footer {
      text-align: center;
      margin-top: 40px;
      padding: 20px;
      color: #999;
      font-size: 13px;
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1>Qisum Email Handtekening</h1>
      <p>Genereer je professionele email handtekening in een paar stappen</p>
    </header>

    <div class="main-content">
      <div class="form-section">
        <div class="form-group">
          <label for="name">Naam</label>
          <input type="text" id="name" placeholder="Jan Jansen">
        </div>
        <div class="form-group">
          <label for="jobTitle">Functietitel</label>
          <input type="text" id="jobTitle" placeholder="Consultant">
        </div>
        <div class="form-group">
          <label for="phone">Telefoonnummer</label>
          <input type="tel" id="phone" placeholder="+31 6 12345678">
        </div>
        <div class="form-group">
          <label for="email">Email</label>
          <input type="email" id="email" placeholder="jan.jansen@qisum.nl">
        </div>
      </div>

      <div class="preview-section">
        <div class="preview-box">
          <h3>Preview</h3>
          <div id="signature-preview"></div>
        </div>
        <button class="btn btn-primary" onclick="copySignature()">
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
          </svg>
          Kopieer Handtekening
        </button>
        <div id="copy-feedback" class="copy-feedback"></div>
      </div>
    </div>

    <div class="instructions">
      <h2>Installatie Instructies</h2>

      <h3>Outlook Desktop (Windows)</h3>
      <ol>
        <li>Vul hierboven je gegevens in</li>
        <li>Klik op <strong>"Kopieer Handtekening"</strong></li>
        <li>Open Outlook en ga naar <strong>Bestand → Opties → E-mail → Handtekeningen</strong></li>
        <li>Klik op <strong>"Nieuw"</strong> en geef een naam (bijv. "Qisum")</li>
        <li>Klik in het tekstveld en plak met <strong>Ctrl+V</strong></li>
        <li>Klik <strong>OK</strong> om op te slaan</li>
      </ol>

      <h3>Outlook Web (Office 365)</h3>
      <ol>
        <li>Vul hierboven je gegevens in en klik op <strong>"Kopieer Handtekening"</strong></li>
        <li>Ga naar <strong>Instellingen</strong> (tandwiel rechtsboven)</li>
        <li>Klik op <strong>"Alle Outlook-instellingen weergeven"</strong></li>
        <li>Ga naar <strong>E-mail → Opstellen en beantwoorden</strong></li>
        <li>Plak de handtekening in het tekstveld</li>
        <li>Klik <strong>Opslaan</strong></li>
      </ol>

      <h3>Outlook voor Mac</h3>
      <ol>
        <li>Vul hierboven je gegevens in en klik op <strong>"Kopieer Handtekening"</strong></li>
        <li>Open Outlook en ga naar <strong>Outlook → Voorkeuren → Handtekeningen</strong></li>
        <li>Klik op <strong>"+"</strong> om een nieuwe handtekening toe te voegen</li>
        <li>Geef een naam en plak met <strong>Cmd+V</strong></li>
        <li>Sluit het venster om op te slaan</li>
      </ol>

      <div class="note">
        <strong>Tip:</strong> Stuur na het instellen een test-email naar jezelf om te controleren of de handtekening correct wordt weergegeven.
      </div>

      <div class="note" style="background: #ffebee; border-left-color: #f44336; margin-top: 12px;">
        <strong>Bekend probleem - Nieuwe Outlook voor Mac:</strong><br>
        De nieuwe Outlook voor Mac heeft een bug waarbij link-kleuren worden overschreven naar blauw.
        <strong>Workaround:</strong> Na het plakken, selecteer elke link apart, klik rechtermuisknop → "Bewerken" en pas de kleur handmatig aan naar roze (#FF1469).
      </div>
    </div>

    <footer>
      Qisum Benelux BV &copy; 2026
    </footer>
  </div>

  <script>
    // Logo URL for email signatures (must be absolute HTTPS URL)
    const LOGO_URL = 'https://rogierd1.github.io/email-signature/Qisum-logo.gif';

    const inputs = ['name', 'jobTitle', 'phone', 'email'];

    // Add event listeners to all inputs
    inputs.forEach(id => {
      document.getElementById(id).addEventListener('input', updatePreview);
    });

    // Initial preview
    updatePreview();

    function getSignatureHTML() {
      const name = document.getElementById('name').value || 'Naam';
      const jobTitle = document.getElementById('jobTitle').value || 'Functietitel';
      const phone = document.getElementById('phone').value || '+31 6 12345678';
      const email = document.getElementById('email').value || 'email@qisum.nl';

      // Simplified signature without links on address
      // Address = plain text (stays black/white in dark mode)
      // Contact info = links with aggressive color styling
      // Note: New Outlook for Mac has a known bug that overrides link colors
      // https://learn.microsoft.com/en-us/answers/questions/5550091/
      return `<!--[if mso]>
<style type="text/css">
a {color: #FF1469 !important; text-decoration: none !important;}
</style>
<![endif]-->
<div style="font-family: Arial, Helvetica, sans-serif; font-size: 12px;">
<table cellpadding="0" cellspacing="0" border="0" style="border-collapse: collapse; font-family: Arial, Helvetica, sans-serif; font-size: 12px;">
  <tr>
    <td colspan="3" style="padding-bottom: 10px; font-family: Arial, Helvetica, sans-serif;">
      <span style="font-size: 14px; font-weight: bold; color: #000000;">${name}</span><br>
      <span style="font-size: 12px; color: #666666;">${jobTitle}</span>
    </td>
  </tr>
  <tr>
    <td style="padding-right: 14px; vertical-align: top;" width="48">
      <img src="${LOGO_URL}" alt="Qisum" width="48" height="65" style="display: block; border: 0; outline: none;">
    </td>
    <td style="padding-right: 14px; padding-left: 2px; vertical-align: top; border-right: 1px solid #E0E0E0;" valign="top">
      <span style="font-family: Arial, Helvetica, sans-serif; font-size: 12px; color: #000000; line-height: 18px;">
        <strong style="color: #000000;">Qisum Benelux BV</strong><br>
        <span style="color: #000000;">Hoogoorddreef 62</span><br>
        <span style="color: #000000;">1101 BE Amsterdam</span>
      </span>
    </td>
    <td style="padding-left: 14px; vertical-align: top;" valign="top">
      <span style="font-family: Arial, Helvetica, sans-serif; font-size: 12px; line-height: 18px;">
        <a href="tel:${phone.replace(/\s/g, '')}" style="color: #FF1469 !important; text-decoration: none !important;"><span style="color: #FF1469;">${phone}</span></a><br>
        <a href="mailto:${email}" style="color: #FF1469 !important; text-decoration: none !important;"><span style="color: #FF1469;">${email}</span></a><br>
        <a href="https://www.qisum.nl" style="color: #FF1469 !important; text-decoration: none !important;"><strong style="color: #FF1469;">www.qisum.nl</strong></a>
      </span>
    </td>
  </tr>
</table>
</div>`;
    }

    function updatePreview() {
      document.getElementById('signature-preview').innerHTML = getSignatureHTML();
    }

    async function copySignature() {
      const signatureHTML = getSignatureHTML();
      const feedback = document.getElementById('copy-feedback');

      try {
        // Try modern Clipboard API with HTML support
        if (navigator.clipboard && window.ClipboardItem) {
          const blob = new Blob([signatureHTML], { type: 'text/html' });
          const item = new ClipboardItem({ 'text/html': blob });
          await navigator.clipboard.write([item]);
          showFeedback('success', 'Handtekening gekopieerd! Plak in Outlook met Ctrl+V (of Cmd+V op Mac)');
        } else {
          // Fallback: use execCommand with contentEditable
          fallbackCopy(signatureHTML);
        }
      } catch (err) {
        console.error('Clipboard API failed:', err);
        // Try fallback
        try {
          fallbackCopy(signatureHTML);
        } catch (fallbackErr) {
          showFeedback('error', 'Kopiëren mislukt. Selecteer de preview handmatig en kopieer met Ctrl+C');
        }
      }
    }

    function fallbackCopy(html) {
      // Create a temporary contentEditable element
      const container = document.createElement('div');
      container.innerHTML = html;
      container.style.position = 'fixed';
      container.style.left = '-9999px';
      container.style.top = '0';
      container.contentEditable = 'true';
      document.body.appendChild(container);

      // Select and copy
      const range = document.createRange();
      range.selectNodeContents(container);
      const selection = window.getSelection();
      selection.removeAllRanges();
      selection.addRange(range);

      const success = document.execCommand('copy');
      document.body.removeChild(container);
      selection.removeAllRanges();

      if (success) {
        showFeedback('success', 'Handtekening gekopieerd! Plak in Outlook met Ctrl+V (of Cmd+V op Mac)');
      } else {
        throw new Error('execCommand copy failed');
      }
    }

    function showFeedback(type, message) {
      const feedback = document.getElementById('copy-feedback');
      feedback.className = 'copy-feedback ' + type;
      feedback.textContent = message;

      // Auto-hide after 5 seconds
      setTimeout(() => {
        feedback.className = 'copy-feedback';
      }, 5000);
    }
  </script>
</body>
</html>
